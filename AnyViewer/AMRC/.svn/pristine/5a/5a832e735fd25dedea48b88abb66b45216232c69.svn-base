#include "stdafx.h"
#include "PortMappingRect.h"
#include <tchar.h>
#include <stdio.h>

CPortMappingRect::CPortMappingRect(int l, int t, int r, int b)
	: Rect(l, t, r, b)
{
}

CPortMappingRect::CPortMappingRect()
{
}

CPortMappingRect::~CPortMappingRect()
{
}

void CPortMappingRect::toString(CStringStorage* string) const
{
	string->format(_T("%dx%d+%d+%d"), right - left, bottom - top, left, top);
}

bool CPortMappingRect::parse(const TCHAR* string, CPortMappingRect* out)
{
	int width, height, x, y;
	TCHAR c;
	if (_stscanf(string, _T("%dx%d+%d+%d%c"), &width, &height, &x, &y, &c) != 4) {
		return false;
	}
	if (width < 0 || height < 0) {
		return false;
	}
	if (out != NULL) {
		out->left = x;
		out->right = x + width;
		out->top = y;
		out->bottom = y + height;
	}
	return true;
}

bool CPortMappingRect::tryParse(const TCHAR* string)
{
	return parse(string, NULL);
}
