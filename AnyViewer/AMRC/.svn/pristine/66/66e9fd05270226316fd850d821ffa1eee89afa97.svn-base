/******************************************************************************
* 
* SaxListCtrl
* Version
* Copyright (C) 2007 Ax3soft Co., Ltd.
* All Rights Reserved
* $Header: /cvsdata/vc/Common/GeneralFunctions.h,v 1.17 2014/12/13 01:42:27 administrator Exp $
* 
*******************************************************************************
* 
* Description:General functions define,Dependent MFC library
******************************************************************************/
#include "stdafx.h"
#include "NetMiscFun.h"
#include "MiscellaneousFunctions.h"
#include <iostream>
#include <sstream>
#include <string>
#include <strstream>
#include <time.h>



/*-----------------------------------------------------------------
|  函数名称  : IDE_IPv4_to_i
|  描    述  : 转换IP地址到整型
|  参    数  : CString& strIpAddress――
|  返 回 值  : 主机字节序
|  修改记录  : 2007-10-27 16:38:57   -huangdy-   创建
-----------------------------------------------------------------*/
unsigned int IPv4_to_i(const std::string& strIpAddress)
{
	unsigned int LENGTH = strIpAddress.size();
	unsigned char chIpAddr[4] = { 0 };
	int nCount = 3;
	unsigned int nCurChar = 0;
	unsigned int i = 0;
	unsigned char nSegmentVal = 0;

	while (i < LENGTH)
	{
		nCurChar = strIpAddress[i];

		if (46/*'.'*/ != nCurChar)
		{
			nSegmentVal *= 10;
			nSegmentVal += ConverHexCharToByte((unsigned char)nCurChar);
		}
		else
		{
			chIpAddr[nCount--] = nSegmentVal;
			nSegmentVal = 0;
			if (-1 == nCount)
			{
				break;
			}
		}
		i++;
	}

	chIpAddr[nCount] = nSegmentVal;

	if (i == LENGTH && 0 == nCount)
	{
		//ATLTRACE(_T("%s\n"),FormatHostIPAddress(*(DWORD*)chIpAddr));
		return *(unsigned int*)chIpAddr;
	}

	return 0;
}